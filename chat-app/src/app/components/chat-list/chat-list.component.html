<div class="chat-list-container">
  <div class="header-wrapper">
    <header class="header">
      <h1>Meus Chats</h1>
      <div class="header-actions">
        <button class="btn-create" (click)="openCreateDialog()">
          + Novo Chat
        </button>
      </div>
    </header>
  </div>

  <div class="content">
    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>

    <div class="loading" *ngIf="loading">
      Carregando chats...
    </div>

    <div class="chat-grid" *ngIf="!loading && chats.length > 0">
      <div 
        class="chat-card" 
        *ngFor="let chat of chats"
        (click)="openChat(chat.codigo_chat)"
      >
        <div class="chat-header">
          <div class="assistant-info">
            <div class="assistant-avatar" *ngIf="chat.foto_assistente">
              <img [src]="chat.foto_assistente" [alt]="chat.nome_assistente" />
            </div>
            <div class="assistant-avatar-placeholder" *ngIf="!chat.foto_assistente">
              {{ chat.nome_assistente.charAt(0) }}
            </div>
            <div class="assistant-name">{{ chat.nome_assistente }}</div>
          </div>
        </div>
        <div class="chat-body">
          <h3>{{ chat.nome_chat }}</h3>
          <p class="chat-date">{{ formatDate(chat.criado_em) }}</p>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="!loading && chats.length === 0">
      <p>Nenhum chat encontrado</p>
      <button class="btn-create" (click)="openCreateDialog()">
        Criar primeiro chat
      </button>
    </div>
  </div>
</div>

<!-- Modal de criação de chat -->
<div class="modal-overlay" *ngIf="showCreateDialog" (click)="closeCreateDialog()">
  <div class="modal" (click)="$event.stopPropagation()">
    <h2>Novo Chat</h2>
    <div class="form-group">
      <label for="chatName">Nome do Chat</label>
      <input
        type="text"
        id="chatName"
        [(ngModel)]="newChatName"
        placeholder="Digite o nome do chat"
        [disabled]="creatingChat"
        (keyup.enter)="createChat()"
      />
    </div>
    <div class="modal-actions">
      <button class="btn-cancel" (click)="closeCreateDialog()" [disabled]="creatingChat">
        Cancelar
      </button>
      <button class="btn-confirm" (click)="createChat()" [disabled]="creatingChat || !newChatName.trim()">
        {{ creatingChat ? 'Criando...' : 'Criar' }}
      </button>
    </div>
  </div>
</div>
